import pandas as pd

df=pd.read_csv("googleplaystore.csv", sep=',', header=0)

# Answer No 1
print(df.columns)
print(df.count())

# Answer No 2
df.Category.count()

# Answer No 3
df.Genres.count()

# Answer No 4
df.sort_values(by='App').App
df.drop_duplicates(subset='App',inplace=True)

# Answer No 5

Removing value on Installs that contains FREEE
df[df['Installs']=='Free']
df_Installs = df[df['Installs'] != 'Free']
df_Installs.head(10)

# Replacing + 
df_Installs['Installs_int']=df_Installs['Installs'].apply(lambda x: x.replace('+', '') if '+' in str(x) else x)
df_Installs.head(10)

# Replacing ,
df_Installs['Installs_int']=df_Installs['Installs_int'].apply(lambda x: x.replace(',', '') if ',' in str(x) else x)
df_Installs.head(10)

# Answer No 6
df_Installs['Installs_int']=df_Installs['Installs_int'].astype(int)
df_Installs.head(10)

# Answer No 7
df_App_Cat = df_Installs[['App','Category']]
df_App_Cat[df_App_Cat.App.str.contains("File Commander")].head(10)
df_App_Cat[df_App_Cat.App=="Pinterest"].head(10)
df_App_Cat[df_App_Cat.App.str.contains("WhatsApp")].head(10)
df_App_Cat[df_App_Cat.App.str.contains("DU Battery")].head(10)
df_App_Cat[df_App_Cat.App.str.contains("Flipboard")].head(10)
df_App_Cat[df_App_Cat.App.str.contains("Subway")].head(10)
df_App_Cat[df_App_Cat.App.str.contains("Dropbox")].head(10)
df_App_Cat[df_App_Cat.App.str.contains("FIFA")].head(10)

# Answer No 8
df_Installs[df_Installs.Installs_int>=1000000000]['App'].unique()

# Answer No 9
df_Installs['Reviews_int']=df_Installs['Reviews'].astype(int)
df_Installs[df_Installs.Category=='COMMUNICATION'].groupby('App').agg({'Reviews_int':'max'}).rename(columns={'Reviews_int':'Max_Review'}).sort_values(by='Max_Review',ascending=False).head(200)

# Answer No 10
df_Installs[df_Installs.Category=='GAME'].groupby('App').agg({'Installs_int':'sum', 'Rating':'sum'}).rename(columns={'Installs_int':'No_Of_Install','Rating':'Total_Ratings'}).sort_values(by=['No_Of_Install','Total_Ratings'],ascending=False).head(200)
